# ğŸ¯ Task: [JEFF-004] Notifications

**Objective:** Email/WhatsApp notifications for status changes and new messages
**Priority:** Medium
**Scope:** Email via Resend, WhatsApp via Twilio/direct API

---

## ğŸ“‹ Requirements

### Functional Requirements
- **[REQ-001]** Email customer when project status changes
- **[REQ-002]** Email admin when customer sends a message
- **[REQ-003]** WhatsApp notification as fallback (optional)
- **[REQ-004]** Notification preferences (opt-out)

### Technical Requirements
- **[TECH-001]** Use Resend for transactional email
- **[TECH-002]** Queue notifications (don't block API response)
- **[TECH-003]** Store customer email in Lead/Project

---

## ğŸ—ï¸ Implementation Plan

### Phase 1: Email Setup
- [ ] Install Resend SDK
- [ ] Create email templates (status change, new message)
- [ ] Add `email` field to Lead model

### Phase 2: Status Change Notification
- [ ] Trigger email in `/api/projects/[id]/status` route
- [ ] Include project name and new status

### Phase 3: Message Notification
- [ ] Trigger email in `/api/projects/[id]/messages` route
- [ ] Different template for customer vs admin

### Phase 4: WhatsApp (Optional)
- [ ] Integrate Twilio WhatsApp API
- [ ] Send WhatsApp when email bounces

---

## ğŸ“ Files to Create/Modify

| File | Action | Purpose |
|------|--------|---------|
| `src/lib/email.ts` | Create | Resend client wrapper |
| `src/lib/email-templates/` | Create | HTML email templates |
| `src/app/api/projects/[id]/status/route.ts` | Modify | Trigger notification |
| `src/app/api/projects/[id]/messages/route.ts` | Modify | Trigger notification |

---

## âœ… Success Criteria

- [ ] Customer gets email on status change
- [ ] Admin gets email on new customer message
- [ ] Emails look professional (branded template)

---

## ğŸ”§ Environment Variables

```env
RESEND_API_KEY=re_xxx
```

---

*Generated by /spawn_task workflow*
