# üéØ Task: Topic Lock & Project Switch Rules

**Objective:** Implement business rules to prevent account sharing while allowing legitimate topic changes.
**Priority:** Medium
**Scope:** Business logic, UI warnings, support flow

---

## üìã Requirements

**[REQ-001]** Pre-Payment Warning
- Add modal/alert before payment: "Topic Lock Notice"
- Warn user to confirm lecturer approval
- Checkbox: "I understand this topic is locked after payment"

**[REQ-002]** Topic Lock Enforcement
- After payment: `isLocked: true` on Project
- Prevent creating new projects (1 per account by default)
- Block "back to topic selection" in builder

**[REQ-003]** Paid Switch Option (‚Ç¶2,000)
- UI: "Request Topic Switch" in settings/support
- Reason selection: "Changed mind" vs "Lecturer rejected"
- Payment flow for self-service switch

**[REQ-004]** Support Flow for Rejections
- If lecturer rejected: user uploads proof screenshot
- Admin reviews and approves free switch
- New table: `TopicSwitchRequest`

---

## üóÉÔ∏è Schema Changes

```prisma
model Project {
  isLocked    Boolean   @default(false)
  lockedAt    DateTime?
}

model TopicSwitchRequest {
  id           String   @id @default(cuid())
  userId       String
  projectId    String
  reason       String   // "changed_mind" | "lecturer_rejected"
  proofUrl     String?  // Screenshot URL
  status       String   @default("pending") // pending | approved | denied
  fee          Int?     // null if free (rejection), 2000 if paid
  createdAt    DateTime @default(now())
  resolvedAt   DateTime?
  resolvedBy   String?  // Admin user ID
}
```

---

## üñºÔ∏è UI Components

1. **Pre-payment warning modal** (before PayStack)
2. **Topic switch request form** (in account settings)
3. **Admin panel for reviewing requests**

---

*Generated by /spawn_task workflow*
