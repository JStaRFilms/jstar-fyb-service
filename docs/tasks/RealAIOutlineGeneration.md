# ğŸ¯ Task: Real AI Outline Generation

**Objective:** Replace the mock/placeholder chapter outline with real AI-generated content using `streamObject`.
**Priority:** High
**Scope:** FR-004 Project Builder - Step 3 (ChapterOutliner)
**Status:** âœ… COMPLETED

---

## ğŸ“‹ Requirements

### Functional Requirements
- **[REQ-001]** âœ… Generate 5 chapter outline based on topic + abstract
- **[REQ-002]** âœ… Stream the outline as it generates (show partial results)
- **[REQ-003]** âœ… Each chapter has: `title`, `content` (description)

### Technical Requirements
- **[TECH-001]** âœ… Use `streamObject` with Zod schema
- **[TECH-002]** âœ… Use `useObject` hook from `@ai-sdk/react` on client
- **[TECH-003]** âœ… Reference `docs/Vercel Ai SDK.md` for correct API usage

---

## ğŸ—ï¸ Implementation Summary

### Phase 1: API Route âœ…
- Fixed invalid model name â†’ `llama-3.3-70b-versatile`
- Imported shared schema from `outlineSchema.ts`
- Uses `streamObject` with proper Zod schema
- Returns `toTextStreamResponse()` for client consumption

### Phase 2: Client Component âœ…
- Replaced mock `useEffect` timeout with `useObject` hook
- Streams chapters progressively as AI generates
- Added wipe reveal animation for dramatic effect
- Error handling with retry button

### Phase 3: Smart Paywall âœ…
- Only triggers AI generation AFTER payment (saves API costs)
- Shows static placeholder chapters when locked
- Prevents hackers from inspecting real content

---

## ğŸ“ Files Created/Modified

| File | Action | Purpose |
|------|--------|---------|
| `src/features/builder/schemas/outlineSchema.ts` | **NEW** | Shared Zod schema |
| `src/app/api/generate/outline/route.ts` | MODIFY | Fixed model, import schema |
| `src/app/api/generate/abstract/route.ts` | MODIFY | Added "no title" instruction |
| `src/features/builder/components/ChapterOutliner.tsx` | MODIFY | `useObject` + paywall logic |
| `src/app/globals.css` | MODIFY | Added wipe-reveal animation |

---

## âœ… Success Criteria

- [x] Outline generates from real AI (not mock data)
- [x] Chapters stream in one by one (visible to user)
- [x] Outline is saved to builder state
- [x] Paywall still works after outline generation
- [x] No API calls until payment (cost optimization)
- [x] Wipe reveal animation on chapters

---

## ğŸ”— Related Files
- `src/app/api/generate/outline/route.ts`
- `src/features/builder/components/ChapterOutliner.tsx`
- `docs/features/FR-004_SaaS_Project_Builder.md` (Updated with full implementation)

---

*Completed: 2025-12-16*
*Generated by /spawn_task workflow*

